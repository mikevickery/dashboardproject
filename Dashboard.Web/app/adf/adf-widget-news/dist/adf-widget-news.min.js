// 10-16-2015 MV custom list of news feeds added to edit screen
!function () {
    "use strict";

    angular.module("adf.widget.news", ["adf.provider"])
        .value("newsServiceUrl", "https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=JSON_CALLBACK&q=")
        .config(["dashboardProvider", function (e) {
            e.widget("news", {
                    title: "News",
                    description: "Select a news feed by source and category",
                    templateUrl: "{widgetsPath}/news/src/view.html",
                    controller: "newsCtrl",
                    reload: !0,  // 10-16-2015 MV added to allow user to refresh news feed
                    resolve: {
                        feed: ["newsService", "config", function (e, t) {
                            return t.url ? e.get(t.url) : void 0
                        }]
                    },
                    edit: {templateUrl: "{widgetsPath}/news/src/edit.html"}
                    })
            }])
        .service("newsService", ["$q", "$http", "newsServiceUrl", function (e, t, r) {
            return {
                get: function (n) {
                    var l = e.defer();
                    return t.jsonp(r + encodeURIComponent(n))
                        .success(function (e) { e && e.responseData && e.responseData.feed ? l.resolve(e.responseData.feed) : l.reject() })
                        .error(function () { l.reject() }), l.promise} }
            }])
        .controller("newsCtrl", ["$scope", "feed", function (e, t) {
            e.feed = t;
            // CUSTOM: adding feed.title to widget.title
            if (typeof t === "object") {
                //console.log(t['title'] + " : " + t['feedUrl']);
                //<h4><a ng-href={{feed.link}} target=_blank>{{feed.title}}</a></h4>
                //this.widget['title'] = "News - " + t['title'];
                e.title = "News - " + t['title'];
                e.$parent.model.title = e.title;
                //FEATURE UPDATE: Add link to title
                //e.$parent.model.title = '<a href="' + t['feedUrl'] + '">' + e.title + '</a>';
                //console.log("New widget title : " + e.title);
            }
        }]),
            angular.module("adf.widget.news").run(["$templateCache", function (e) {
                //e.put("{widgetsPath}/news/src/edit.html", '<form role=form><div class=form-group><label for=url>Feed Url</label> <input type=url class=form-control id=url ng-model=config.url placeholder="Enter feed url here"></div></form>'),
                //REFACTOR: ISSUE MOVE TO CONTROLLER
                e.put("{widgetsPath}/news/src/edit.html", '<form role=form><div class=form-group> ' +
                    '<div style="display: inline-block; width:135px"><label>CNN </label><br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_topstories.rss" id=url ng-model=config.url ng-model=definition.title> Top Stories<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_world.rss" id=url ng-model=config.url> World<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_us.rss" id=url ng-model=config.url> U.S.<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/money_latest.rss" id=url ng-model=config.url> Business<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_allpolitics.rss" id=url ng-model=config.url> Politics<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_tech.rss" id=url ng-model=config.url> Technology<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_health.rss" id=url ng-model=config.url> Health<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_showbiz.rss" id=url ng-model=config.url> Entertainment<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_travel.rss" id=url ng-model=config.url> Travel<br />' +
                    '<input type="radio" value="http://rss.cnn.com/rss/cnn_freevideo.rss" id=url ng-model=config.url> Video' +
                    '</div><div style="display: inline-block; width:135px"><label>ABC </label><br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/sportsheadlines" id=url ng-model=config.url> ESPN Sports<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/topstories" id=url ng-model=config.url> Top Stories<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/internationalheadlines" id=url ng-model=config.url> World<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/usheadlines" id=url ng-model=config.url> U.S.<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/moneyheadlines" id=url ng-model=config.url> Business<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/politicsheadlines" id=url ng-model=config.url> Politics<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/technologyheadlines" id=url ng-model=config.url> Technology<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/entertainmentheadlines" id=url ng-model=config.url> Entertainment<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/travelheadlines " id=url ng-model=config.url> Travel<br />' +
                    '<input type="radio" value="http://feeds.abcnews.com/abcnews/2020headlines" id=url ng-model=config.url> 20/20 Headlines' +
                    '</div><div style="display: inline-block; width:135px; valign:top"><label>NPR </label><br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1001" id=url ng-model=config.url> News Headlines<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=100" id=url ng-model=config.url> Most E-mailed<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1008" id=url ng-model=config.url> Arts &amp; Culture<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1006" id=url ng-model=config.url> Business<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1007" id=url ng-model=config.url> Health &amp; Science<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1057" id=url ng-model=config.url> Opinion<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1021" id=url ng-model=config.url> People &amp; Places<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1012" id=url ng-model=config.url> Politics<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1003" id=url ng-model=config.url> U.S. News<br />' +
                    '<input type="radio" value="http://www.npr.org/rss/rss.php?id=1004" id=url ng-model=config.url> World News' +
                    '</div><div style="display: inline-block; width:135px; valign:top"><label>Science Daily</label><br />' +
                    '<input type="radio" value="http://sciencedaily.com/newsfeed.xml" id=url ng-model=config.url> All News<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/top/science.xml" id=url ng-model=config.url> Science<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/top.xml" id=url ng-model=config.url> Top News<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/health_medicine.xml" id=url ng-model=config.url> Health &amp; Medicine<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/top/technology.xml" id=url ng-model=config.url> Technology<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/top/environment.xml" id=url ng-model=config.url> Environment<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/top/society.xml" id=url ng-model=config.url> Society<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/most_popular.xml" id=url ng-model=config.url> Most Popular<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/mind_brain.xml" id=url ng-model=config.url> Mind &amp; Brain<br />' +
                    '<input type="radio" value="http://sciencedaily.com/rss/strange_offbeat.xml" id=url ng-model=config.url> Strange &amp; Offbeat' +
                    '</div></div></form>'),
                e.put("{widgetsPath}/news/src/view.html", '<div class=news><div class="alert alert-info" ng-if=!feed>Edit the widget to select a news feed</div><ul><li ng-repeat="entry in feed.entries"><a ng-href={{entry.link}} target=_blank>{{entry.title}}</a></li></ul></div>')
                //e.put("{widgetsPath}/news/src/view.html", '<div class=news><div class="alert alert-info" ng-if=!feed>Edit the widget to select a news feed</div><h4><a ng-href={{feed.link}} target=_blank>{{feed.title}}</a></h4><ul><li ng-repeat="entry in feed.entries"><a ng-href={{entry.link}} target=_blank>{{entry.title}}</a></li></ul></div>')
        }]) 
}(window);