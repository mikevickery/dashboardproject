!function () {
    "use strict";
    angular.module("adf.widget.weather", ["adf.provider"])
        //api.openweathermap.org/data/2.5/forecast/city?id=524901&APPID=1111111111
        .value("weatherServiceUrl", "http://api.openweathermap.org/data/2.5/weather?units=imperial&APPID=698ee4554c8c1dca1920fc59b14f9c7f&callback=JSON_CALLBACK&q=")
        //.value("weatherServiceUrl", "http://api.openweathermap.org/data/2.5/weather?units=metric&APPID=698ee4554c8c1dca1920fc59b14f9c7f&callback=JSON_CALLBACK&q=")
        //.value("weatherServiceUrl", "https://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=JSON_CALLBACK&q=")
        .config(["dashboardProvider", function (e) {
            e.widget("weather", {
                title: "Weather",
                description: "Display the current temperature of a city",
                templateUrl: "{widgetsPath}/weather/src/view.html",
                controller: "weatherCtrl",
                reload: !0,
                resolve: {
                    data: ["weatcherService", "config", function (e, t) { return t.location ? e.get(t.location) : void 0 }]
                },
                edit: { templateUrl: "{widgetsPath}/weather/src/edit.html" }
            })
        }])
        .service("weatcherService", ["$q", "$http", "weatherServiceUrl", function (e, t, r) { return { get: function (a) { var i = e.defer(), o = r + a; return t.jsonp(o).success(function (e) { e && 200 === e.cod ? i.resolve(e) : i.reject() }).error(function () { i.reject() }), i.promise } } }])
        .controller("weatherCtrl", ["$scope", "data", function (e, t) {
            e.data = t;
            if (typeof t === "object") {
                e.title = "Weather - " + t['name'];
                e.$parent.model.title = e.title;
            }
        }]),
    angular.module("adf.widget.weather")
        .run(["$templateCache", function (e) {
            e.put("{widgetsPath}/weather/src/edit.html", '<form role=form><div class=form-group><label for=location>Location</label> <input type=location class=form-control id=location ng-model=config.location placeholder="Enter location"></div></form>'),
            e.put("{widgetsPath}/weather/src/view.html", '<div class=text-center><div class="alert alert-info" ng-if=!data>Please insert a location in the widget configuration</div><div class=weather ng-if=data><h4>{{data.name}} ({{data.sys.country}})</h4><dl><dt>Currently {{data.main.temp | number:0}}&#176;</dt><dd><p style="font-size:xx-small;">Longitude: {{data.coord.lon | number}} Latitude: {{data.coord.lat | number}}</p></dd></dl></div></div>')
        }])
}(window);